<htmlform>
	<!-- Autogenerated example form  (template from 01-Nov-2010 -->
	<macros>
		paperFormId = (Fill this in)
		headerColor =#009d8e
		fontOnHeaderColor = white
	</macros>

	<style>
		.section {
			border: 1px solid $headerColor;
			padding: 2px;
			text-align: left;
			margin-bottom: 1em;
		}
		.sectionHeader {
			background-color: $headerColor;
			color: $fontOnHeaderColor;
			display: block;
			padding: 2px;
			font-weight: bold;
		}
		table.baseline-aligned td {
			vertical-align: baseline;
		}
	</style>
      	<span style="float:right">Paper Form ID: $paperFormId</span>
	<h2>PET-Counselling Follow-up (v0.2.0-beta)</h2>

	<section headerLabel="1. Encounter Details">
		<table class="baseline-aligned">
			<tr>
				<td>Date:</td>
				<td><encounterDate default="today"/></td>
			</tr>
			<tr>
				<td>Location:</td>
				<td><encounterLocation/></td>
			</tr>
			<tr>
				<td>Provider:</td>
				<td><encounterProvider default="currentUser" type="autocomplete"/></td>
			</tr>
		</table>
	</section>

	<section headerLabel="2. Counselling Follow-up Information">
		<div>
			<p>
				Follow up Month
				<br/>
				<obs conceptId="164327" id="followup_month" maxLength="2" required="true"/>
			</p>
			
			<p>
				Referral Complain
				<br/>
				<obs conceptId="164328" id="referral_complaint" maxLength="250" size="35" />
			</p>
			
			<p>
				How many days worth of medication was missed in the past month?
				<br/>
				<obs conceptId="162878" id="missed_dose" required="true" />
			</p>
			
			<p>
				Is the contact adherent to PET?
				<br/>
				<obs conceptId="164329" id="patient_adherence" required="true" answerConceptIds="1065,1066" >
                                <controls>
                                       <when value="1066" thenDisplay="#reason_nonadherent" />
                               </controls>
				</obs>
			</p>
			
			<p id="reason_nonadherent">
				Reasons for non-adherent
				<br/>
				<obs conceptId="164330" id="nonadherence_reasons" maxLength="250" size="35" /> <label style="color:red">*</label>
			</p>
			
			<p>
				Are there any adverse events?
				<br/>
				<obs conceptId="164296" id="adverse_events_reported" required="true" answerConceptIds="1065,1066" >
				</obs>
			</p>
		<div id="adverse_effects">
			<p>
				Adverse effects <label style="color:red">*</label> <label id="adverse_event_error" style="color:red"></label>
				<br/>
				<obsgroup groupingConceptId="164295">
				<obs conceptId="164295" answerConceptId="80" style="checkbox" id="cb_adverse_event_1"/>
				<br/>
				<obs conceptId="164295" answerConceptId="139084" style="checkbox" id="cb_adverse_event_2"/>
				<br/>
				<obs conceptId="164295" answerConceptId="512" style="checkbox" id="cb_adverse_event_3"/>
				<br/>
				<obs conceptId="164295" answerConceptId="5978" style="checkbox" id="cb_adverse_event_4"/>
				<br/>
				<obs conceptId="164295" answerConceptId="141830" style="checkbox" id="cb_adverse_event_5"/>
				<br/>
				<obs conceptId="164295" answerConceptId="122983" style="checkbox" id="cb_adverse_event_6"/>
				<br/>
				<obs conceptId="164295" answerConceptId="151" style="checkbox" id="cb_adverse_event_7"/>
				<br/>
				<obs conceptId="164295" answerConceptId="135595" style="checkbox" id="cb_adverse_event_8"/>
				<br/>
				<obs conceptId="164295" answerConceptId="159298" style="checkbox" id="cb_adverse_event_9"/>
				<br/>
				<obs conceptId="164295" answerConceptId="164294" style="checkbox"   id="cb_other_adverse_event"/>   
				</obsgroup>
           	        
			</p>
                         <p id="other_adverse_event_div">
				Other adverse effects 
				<br/>
				 <obs conceptId="164294" id="other_adverse_event" maxLength="250" /> <label style="color:red">*</label>
		       </p>
          </div>

			<p>
				Who is giving medicines to child contact?
				<br/>
				<obs conceptId="160640" id="treatment_supporter_relation"  answerConceptIds="978,970,971,160723,160724,160726,160725,160729,160730,160727,160728,5617,975,974,5620" defaultValue="970"  required="true">
				<controls>
                                       <when value="5620" thenDisplay="#other_treatment_supporter_relation_div" />
                               </controls>
				</obs>			   
			</p>
			
			<p id="other_treatment_supporter_relation_div">
				Other
				<br/>
				 <obs conceptId="5620" id="other_treatment_supporter_relation" maxLength="250"/> <label style="color:red">*</label>
		    </p>
			
			<p>
				Are there any behavioural complains since starting PET?
				<br/>
				<obs conceptId="164332" id="behaviour_complains" required="true" answerConceptIds="1065,1066" > 
                                <controls>
                                       <when value="1065" thenDisplay="#complains" />
                               </controls>
                               </obs>
			</p>
			
			<p id="complains">
				Behavioural complaints after starting PET  
				<br/>
				<obs conceptId="164291" id="contact_behaviour"  answerConceptIds="6023,164292,116631,121748,164284,164286,165558,164287,164288,164289,164290" answerLabels="Irritable,Stubborn,Shy/Introvert,Aggressive,Argumentative,Non Complaint,Complaint,Responsible,Co-operative,Non-Cooperative,Others">

                                 <controls>
                                       <when value="164290" thenDisplay="#other_complain" /> 
                               </controls>
                               </obs>  <label style="color:red">*</label>
			</p>
		<div id="other_complain">
			<p>
				Others
				<br/>
				<obs conceptId="164290" id="other_behaviour" maxLength="250"/> <label style="color:red">*</label>
			</p>
		</div>
			
			<p>
				Are the parents/caretakers negligent towards PET?
				<br/>
				<obs conceptId="164333" id="treatment_supporter_negligence" required="true" answerConceptIds="1065,1066"  >
                        <controls>
					<when value="1065" thenDisplay="#negligence_reason" />
                        </controls>
				</obs>
			</p>
			
			<p id="negligence_reason">
				Reasons for negligence towards PET
				<br/>
				<obs conceptId="164334" id="treatment_supporter_negligence_reason" maxLength="100" size="35" />
			</p>
			
			<p>
				Any misconceptions after initiating PET?
				<br/>
				<obs conceptId="164335" id="treatment_misconceptions" answerConceptIds="1065,1066"  required="true">
                        <controls>
                            <when value="1065" thenDisplay="#misconception" />
                        </controls>
				</obs>
			</p>
			
			<p id="misconception">
				PET misconceptions
				<br/>
				<obs conceptId="164336" id="treatment_misconception_explain" maxLength="250" size="35" />
			</p>		
			
			<p>
				Is the Index patient following infection control measures?
				<br/>
				<obs conceptId="164338" id="infection_control_following" answerConceptIds="1065,1066" required="true">
						<controls>
                            <when value="1066" thenDisplay="#infection_counseling" />
                        </controls>
				</obs>
			</p>
			
			<p id="infection_counseling" >
				Counseling of the index patient for infection control
				<br/>
				<obs conceptId="164339" id="infection_control_counseling" answerConceptIds="1065,1066"/>
			</p>
			
			
			<p>
				Is the patient facing any of these problems?
				<br/>
				<obs conceptId="164340" id="patient_problem" answerConceptIds="150504,141537,160067,1067,164106,5622" required="true" answerLabels="Academic problems,Economic problems,Health problems,Unknown,Refused,Others">
                        <controls>
                            <when value="5622" thenDisplay="#other_problem" />
                        </controls>
				</obs>
			</p>
			
			<p id="other_problem">
				Others
				<br/>
				<obs conceptId="5622" id="other_patient_problem" maxLength="250" size="35" />
			</p>
			
			<p>
				Contact's comments
				<br/>
				<obs conceptId="164293" id="patient_comments" maxLength="1000" size="35"/>
			</p>
			
			<p>
				Psychologist's comments
				<br/>
				<obs conceptId="164237" id="doctor_notes" maxLength="1000" size="35" />
			</p>
			
	</div>
	
	</section>
<submit/>
<script type="text/javascript">
var startDate = new Date();


 jQuery( document ).ready(function() {

<ifMode mode="ENTER">
$j('#adverse_effects').hide();
</ifMode>

<ifMode mode="EDIT">

if(getValue('adverse_events_reported.value') == 1065){
    $j('#adverse_effects').show();
}else
 $j('#adverse_effects').hide();

if(getValue('cb_other_adverse_event.value') == 164294){
			$j('#other_adverse_event_div').hide();
			}
        

</ifMode>
});

	jQuery(function() {


getField('adverse_events_reported.value').change(function() {

                        var checked= getValue('adverse_events_reported.value');
                        if(checked == '1065'){
                             			$j('#adverse_effects').show();

 var checked= getValue('cb_other_adverse_event.value');
                        if(checked == '164294')
                             			$j('#other_adverse_event_div').show();


                         else{
                             			$j('#other_adverse_event_div').hide();

                                    setValue('other_adverse_event.value', '');}

}
                         else{
                             			$j('#adverse_effects').hide();
                                                setValue('cb_adverse_event_8.value','');
setValue('cb_adverse_event_7.value','');
setValue('cb_adverse_event_6.value','');
setValue('cb_adverse_event_5.value','');
setValue('cb_adverse_event_4.value','');
setValue('cb_adverse_event_3.value','');
setValue('cb_adverse_event_2.value','');
setValue('cb_adverse_event_1.value','');
setValue('cb_other_adverse_event.value','');
}
                });


getField('cb_other_adverse_event.value').change(function() {

                        var checked= getValue('cb_other_adverse_event.value');
                        if(checked == '164294')
                             			$j('#other_adverse_event_div').show();


                         else{
                             			$j('#other_adverse_event_div').hide();

                                    setValue('other_adverse_event.value', '');

}
                });

		getField('behaviour_complains.value').change(function() {
                        if(getValue('behaviour_complains.value') == 1066 || getValue('behaviour_complains.value') ==''){
                              $j('#other_complain').hide();
                        }
                });
				});
		beforeSubmit.push(function() {
		var error1=true,error2=true,error3=true,error4=true,error5=true,error6=true,error7=true;

			setValue('followup_month.error', '');
			setValue('nonadherence_reasons.error', '');
			setValue('other_behaviour.error', '');
			setValue('other_patient_problem.error', '');
			setValue('treatment_supporter_negligence_reason.error', '');
			setValue('treatment_misconception_explain.error', '');
			
			if(getValue('adverse_events_reported.value') == 1065){
			
				var val = getValue('cb_other_adverse_event.value');
				var val1 = getValue('cb_adverse_event_1.value');
				var val2 = getValue('cb_adverse_event_2.value');
				var val3 = getValue('cb_adverse_event_3.value');
				var val4 = getValue('cb_adverse_event_4.value');
				var val5 = getValue('cb_adverse_event_5.value');
				var val6 = getValue('cb_adverse_event_6.value');
				var val7 = getValue('cb_adverse_event_7.value');
				var val8 = getValue('cb_adverse_event_8.value');
				var val9 = getValue('cb_adverse_event_9.value');
				
				if(val == null &amp;&amp; val1 == null &amp;&amp; val2 == null &amp;&amp; val3 == null &amp;&amp; val4 == null &amp;&amp; val5 == null &amp;&amp; val6 == null &amp;&amp; val7 == null &amp;&amp; val8 == null){
					document.getElementById('adverse_event_error').innerHTML = 'This field can not be null';
					error7=false;
				}else{
				    document.getElementById('adverse_event_error').innerHTML = '';
				}
			
			}
			
			if(getValue('cb_other_adverse_event.value') == 164294 &amp;&amp; getValue('other_adverse_event.value') == ''){
					getField('other_adverse_event.error').html('This field can not be null').show();
					error7=false;
			}else{
					getField('other_adverse_event.error').html('').hide();
			}
			
			if(getValue('treatment_supporter_relation.value') == 5620 &amp;&amp; getValue('other_treatment_supporter_relation.value') == ''){
					getField('other_treatment_supporter_relation.error').html('This field can not be null').show();
					error7=false;
			}else{
					getField('other_treatment_supporter_relation.error').html('').hide();
			}
			
			if(getValue('behaviour_complains.value') == 1065 &amp;&amp; getValue('contact_behaviour.value') == ''){
					getField('contact_behaviour.error').html('This field can not be null').show();
					error7=false;
			}else{
					getField('contact_behaviour.error').html('').hide();
			}
			
			if(getValue('contact_behaviour.value') == 164290 &amp;&amp; getValue('other_behaviour.value') == ''){
					getField('other_behaviour.error').html('This field can not be null').show();
					error7=false;
			}else{
					getField('other_behaviour.error').html('').hide();
			}
			
			if(getValue('infection_control_following.value') == 1066 &amp;&amp; getValue('infection_control_counseling.value') == ''){
					getField('infection_control_counseling.error').html('This field can not be null').show();
					error7=false;
			}else{
					getField('infection_control_counseling.error').html('').hide();
			}
			
			if(getValue('followup_month.value') &lt;0 || getValue('followup_month.value') &gt;24){
					getField('followup_month.error').html('Value out of range. Please enter valid month (i.e between 1-24)').show();
					error1=false;
			}
			else{

var val = getValue('followup_month.value') ;
	 if((parseFloat(val) == parseInt(val)) &amp;&amp; !isNaN(val)){
      getField('followup_month.error').html('').hide();
	} else {
      getField('followup_month.error').html('Not an Integer').show();
							  error1=false;
	}
			}
			if(getValue('patient_adherence.value')==1066 &amp;&amp; getValue('nonadherence_reasons.value')==''){
					getField('nonadherence_reasons.error').html('This field can not be null').show();
					error2=false;
			}
			else{
					getField('nonadherence_reasons.error').html('').hide();
					error2=true;
			}
			if(getValue('contact_behaviour.value')==164290 &amp;&amp; getValue('other_behaviour.value')==''){
					getField('other_behaviour.error').html('This field can not be null').show();
					error3=false;
			}
			else{
					getField('other_behaviour.error').html('').hide();
					error3=true;
			}
			if(getValue('patient_problem.value')==5622 &amp;&amp; getValue('other_patient_problem.value')==''){
					getField('other_patient_problem.error').html('This field can not be null').show();
					error4=false;
			}
			else{
					getField('other_patient_problem.error').html('').hide();
					error4=true;
			}
			
			if(getValue('treatment_supporter_negligence.value')==1065 &amp;&amp; getValue('treatment_supporter_negligence_reason.value')==''){
					getField('treatment_supporter_negligence_reason.error').html('This field can not be null').show();
					error5=false;
			}
			else{
					getField('treatment_supporter_negligence_reason.error').html('').hide();
					error5=true;
			}
			
			if(getValue('treatment_misconceptions.value')==1065 &amp;&amp; getValue('treatment_misconception_explain.value')==''){
					getField('treatment_misconception_explain.error').html('This field can not be null').show();
					error6=false;
			}
			else{
					getField('treatment_misconception_explain.error').html('').hide();
					error6=true;
			}
			
			if(error1 == false || error2==false || error3==false || error4==false || error5==false || error6==false || error7==false){
				return false;
		}
		else{
			var endDate = new Date();
			var timeDiff = Math.abs(endDate.getTime() - startDate.getTime());
			var diffSec = timeDiff/1000;
			alert(diffSec + " seconds to fill form");
				return true;
			}
			
			return truel;

		});

</script>

</htmlform>