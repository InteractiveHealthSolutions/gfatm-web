<htmlform>
	<!-- Developed by Tahira -->
	<!-- Autogenerated example form  (template from 01-Nov-2010 -->
	<macros>
		paperFormId = (Fill this in)
		headerColor =#009d8e
		fontOnHeaderColor = white
	</macros>

	<style>
		.section {
			border: 1px solid $headerColor;
			padding: 2px;
			text-align: left;
			margin-bottom: 1em;
		}
		.sectionHeader {
			background-color: $headerColor;
			color: $fontOnHeaderColor;
			display: block;
			padding: 2px;
			font-weight: bold;
		}
		table.baseline-aligned td {
			vertical-align: baseline;
		}
	</style>

	<span style="float:right">Paper Form ID: $paperFormId</span>
	<h2>PMDT-Contact Registry(v0.0.1-alpha)</h2>

	<section headerLabel="1. Encounter Details">
		<table class="baseline-aligned">
			<tr>
				<td>Date:</td>
				<td><encounterDate default="today"/></td>
			</tr>
			<tr>
				<td>Location:</td>
				<td><encounterLocation default="1"/></td>
			</tr>
			<tr>
				<td>Provider:</td>
				<td><encounterProvider default="currentUser" type="autocomplete"/></td>
			</tr>
		</table>
	</section>

	<section headerLabel="2. Contact Registry Information ">
		<div>

                        <p>
				Date of household contact registry
				<br/>
				<obs conceptId="165600" id="contact_registry_date" required="true"/>
			</p>

			<p>
				Total Number of Contacts
				<br/>
				<obs conceptId="164087" id="contacts" required="true" size="5"/>
			</p>

            <p>
				Total Number of adult contacts
                <br/>
				<obs conceptId="164088" id="adult_contacts" required="true" size="5"/>
			</p>
			
            <p>
				Total Number of childhood contacts
                <br/>
				<obs conceptId="164089" id="childhood_contacts" required="true" size="5" />
			</p>

Total Number of Contacts : <lookup complexExpression="#foreach($contacts in $fn.allObs(164087)) $contacts.valueNumeric #end"/>



 
		</div>
	</section>

	<submit/>

    <script type="text/javascript">
        var startDate = new Date();
		 jQuery(function() {
				var sum=0;
				getField('contacts.value').change(function() {
					if(getValue('contacts.value') &lt; 0 || getValue('contacts.value') &gt; 50){
							getField('contacts.error').html('Value out of range. Value should be between 0-50').show();
					}
					else{
						getField('contacts.error').html('').hide();
					}
					sum = +getValue('adult_contacts.value') + +getValue('childhood_contacts.value');
					setValue('contacts.value',sum);
				});
				getField('adult_contacts.value').change(function() {
					if(getValue('adult_contacts.value') &lt; 0 || getValue('adult_contacts.value') &gt; 25){
							getField('adult_contacts.error').html('Value out of range. Value should be between 0-25').show();
					}
					else{
						getField('adult_contacts.error').html('').hide();
					}
					sum = +getValue('adult_contacts.value') + +getValue('childhood_contacts.value');
					setValue('contacts.value',sum);
				});
				getField('childhood_contacts.value').change(function() {
					if(getValue('childhood_contacts.value') &lt; 0 || getValue('childhood_contacts.value') &gt; 25){
							getField('childhood_contacts.error').html('Value out of range. Value should be between 0-25').show();
					}
					else{
						getField('childhood_contacts.error').html('').hide();
					}
					sum = +getValue('adult_contacts.value') + +getValue('childhood_contacts.value');
					setValue('contacts.value',sum);
				});

showAlert();
					
        });

                function showAlert() {
                                   var conceptList = "<lookup expression="fn.latestObs(164087).valueNumeric"/>";
                                   var encounter = "<lookup expression="fn.latestEncounter()"/>";
                                   console.log(conceptList[0]);
                                   
                                   
                }


		beforeSubmit.push(function() {
            var error=true;
			setValue('contacts.error', '');
            setValue('adult_contacts.error','');
			setValue('childhood_contacts.error','');
			   
            if(getValue('contacts.value') &lt; 0 || getValue('contacts.value') &gt; 50){
				getField('contacts.error').html('Value out of range. Value should be between 0-50').show();
				error=false;
			}
			else{
				getField('contacts.error').html('').hide();
			}
			if(getValue('adult_contacts.value') &lt; 0 || getValue('adult_contacts.value') &gt; 25){
				getField('adult_contacts.error').html('Value out of range. Value should be between 0-25').show();
				error=false;
			}
			else{
				getField('adult_contacts.error').html('').hide();
			}
			if(getValue('childhood_contacts.value') &lt; 0 || getValue('childhood_contacts.value') &gt; 25){
				getField('childhood_contacts.error').html('Value out of range. Value should be between 0-25').show();
				error=false;
			}
			else{
				getField('childhood_contacts.error').html('').hide();
			}
            if(error==false){
				return false;
            }
            else{
				var endDate = new Date();
                var timeDiff = Math.abs(endDate.getTime() - startDate.getTime());
				var diffSec = timeDiff/1000;
				alert(diffSec + " seconds to fill form");
                return true;
            } 
		});
    </script>

<!-- END OF FORM

Simple examples to copy-and-paste. Full reference at http://wiki.openmrs.org/x/kg8z

SECTION
	<section headerLabel="\#. Title">
		Content
	</section>

NUMERIC OBSERVATION
	<obs conceptId="id-of-numeric-concept" labelText="Label before"/>

DATE OBSERVATION
	<obs conceptId="id-of-date-concept" labelText="Label before"/>

CODED OBSERVATION
(as a dropdown)
	<obs conceptId="id-of-coded-concept" labelText="Label before"/>
(as radio buttons)
	<obs conceptId="id-of-coded-concept" labelText="Label before" style="radio"/>
(as an autocomplete)
	<obs conceptId="id-of-coded-concept" labelText="Label before" style="autocomplete" answerClasses="Diagnosis"/>
(as a checkbox for a specific answer)
	<obs conceptId="id-of-coded-concept" labelText="Label before" answerConceptId="id-of-answer-concept" answerLabel="label for answer"/>
(as a dropdown with specific choices)
	<obs conceptId="id-of-coded-concept" labelText="Label before" answerConceptIds="concept-id-1,concept-id-2,concept-id-3" answerLabels="Label 1,Label 2, Label 3"/>


FREE TEXT OBSERVATION
(as a normal text field)
	<obs conceptId="id-of-text-concept" labelText="Label before"/>
(as a textarea)
	<obs conceptId="id-of-text-concept" labelText="Label before" rows="4" cols="80"/>
-->
</htmlform>