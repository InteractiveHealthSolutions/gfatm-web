<htmlform>
	<!-- Developed by Wasim -->
	<!-- Autogenerated example form  (template from 01-Nov-2010 -->
	<macros>
		paperFormId = (Fill this in)
		headerColor =#009d8e
		fontOnHeaderColor = white
	</macros>

	<style>
		.section {
			border: 1px solid $headerColor;
			padding: 2px;
			text-align: left;
			margin-bottom: 1em;
		}
		.sectionHeader {
			background-color: $headerColor;
			color: $fontOnHeaderColor;
			display: block;
			padding: 2px;
			font-weight: bold;
		}
		table.baseline-aligned td {
			vertical-align: baseline;
		}
	</style>

	<span style="float:right">Paper Form ID: $paperFormId</span>
	<h2>PMDT-Post Treatment Outcome (v0.0.1)</h2>

	<section headerLabel="1. Encounter Details">
		<table class="baseline-aligned">
			<tr>
				<td>Date:</td>
				<td><encounterDate default="today"/></td>
			</tr>
			<tr>
				<td>Location:</td>
				<td><encounterLocation/></td>
			</tr>
			<tr>
				<td>Provider:</td>
				<td><encounterProvider/></td>
			</tr>
		</table>
	</section>

	<section headerLabel="2. Post Treatment Outcome Information">
		
		<p>
			Post Treatment Outcome date
			<br/>
			<obs conceptId="165168" id="date_post_treatment_outcome" default="today" required="true"/>
		</p>
		
		<p>
			Number of months past end of treatment
			<br/>
			<obs conceptId="165177" id="month_post_treatment_outcome" required="true" defaultValue="6" maxlength="3"/>
		</p>
		<p>
		Outcome:
		<br/>
			<obs conceptId="165175" id="post_treatment_outcome" answerConceptIds="165169,165170,165173,165174,164791" 
			answerLabels=" No change in outcome since end of treatment,Died post treatment, Relapse or recurrence, 
			Lost to follow-up post treatment, Not evaluated" required="true" defaultValue="165169"/>
		</p>
		
		<div id="date_death_div">
			<p>
				If died, then provide date of death:
				<br/>
				<obs conceptId="1543" id="date_death"/>
			</p>
		</div>
		
		<div id="primary_cause_death_div">
			<p>
				If died: then provide suspected primary cause of death:
				<br/>
				<obs conceptId="165144" id="primary_cause_death" answerConceptIds="165139,165140,165141,165142,165143,1067" 
			answerLabels="TB immediate cause of death,Cause related to TB treatment, TB contributing to death, 
			Surgery related death, Cause other than TB,Unknown" defaultValue="1067"/>
			</p>
		</div>
		
		<div id="cause_death_surgery_div">
			<p>
			If primary cause of death surgery related, then specify type of surgery:
			<br/>
			<obs conceptId="165148" id="cause_death_surgery" maxlength="100"/>
			</p>
		</div>
		<div id="cause_death_other_div">
			<p>
			If primary cause of death other than TB, then specify:
			<br/>
			<obs conceptId="165143" id="cause_death_other" maxlength="100"/>
			</p>
		</div>
		<div id="lost_follow_up_div">
			<p>
				If lost to follow-up, why was the patient's treatment interrupted?
				<br/>
				<obs conceptId="161206" id="reason_follow_up" answerConceptIds="165156,112603,164340,165158,164482,1067" 
			answerLabels="Patient refused follow-up,Substance abuse,Social problem, 
			Left region/country,Other,Unknown" defaultValue="165156"/>
			</p>
		</div>
		<div id="reason_follow_up_other_div">
			<p>
			If reason for lost to follow-up 'Other', then specify:
			<br/>
			<obs conceptId="164482" id="reason_follow_up_other" maxlength="255"/>
			</p>
		</div>
		<div id="not_evaluated_transfer_out_div">
			<p>
			<br/>
			 If not evaluated, was the patient transferred out? 
			<obs conceptId="160036" id="not_evaluated_transfer_out" answerConceptIds="1065,1066" defaultValue="1065"/>
			</p>
		</div>
		<div id="transfer_out_facility_div">
			<p>
			<br/>
			 If transferred out, then to which facility? 
			<obs conceptId="159495" id="transfer_out_facility" style="location" answerLocationTags="PMDT"/>
			</p>
		</div>
		<div id="transfer_out_facility_other_div">
				<p>
				If treatment facility 'Other', then specify:
				<br/>
				<obs conceptId="165693" id="transfer_out_facility_other" maxlength="100" />
				</p>
		</div>
		<div id="reason_not_evaluated_other_div">
				<p>
				If not transferred out, why does the patient have this outcome?
				<br/>
				<obs conceptId="165166" id="reason_not_evaluated_other" maxlength="100" />
				</p>
		</div>
		
		
	</section>

	<submit/>
	
	<script type="text/javascript">
	
	var startDate = new Date();
		
	$j('#date_death_div').hide(); 
	$j('#primary_cause_death_div').hide();
	$j('#lost_follow_up_div').hide();
	$j('#not_evaluated_transfer_out_div').hide();
	$j('#cause_death_surgery_div').hide();
	$j('#cause_death_other_div').hide();
	$j('#reason_follow_up_other_div').hide();
	$j('#reason_not_evaluated_other_div').hide();
	$j('#transfer_out_facility_div').hide();
	$j('#transfer_out_facility_other_div').hide();
	
	jQuery(function() {
			getField('post_treatment_outcome.value').change(function(){
                                  if(getValue('post_treatment_outcome.value')==165170){
                                             $j('#date_death_div').show();
											 $j('#primary_cause_death_div').show();
                                   }else{
                                           $j('#date_death_div').hide();
										   $j('#primary_cause_death_div').hide();
										   $j('#cause_death_surgery_div').hide();
										   $j('#cause_death_other_div').hide();
                                   }
								   if(getValue('post_treatment_outcome.value')==165174){
                                             $j('#lost_follow_up_div').show();
                                   }else{
                                           $j('#lost_follow_up_div').hide();
										   $j('#reason_follow_up_other_div').hide();
                                   }
								   
								   if(getValue('post_treatment_outcome.value')==164791){
                                             $j('#not_evaluated_transfer_out_div').show();
                                   }else{
                                           $j('#not_evaluated_transfer_out_div').hide();
										   $j('#transfer_out_facility_div').hide();
										   $j('#transfer_out_facility_other_div').hide();
										   $j('#reason_not_evaluated_other_div').hide();
                                   }
			});
		});
		
		jQuery(function() {
			getField('primary_cause_death.value').change(function(){
                                  if(getValue('primary_cause_death.value')==165142){
                                             $j('#cause_death_surgery_div').show();
                                   }else{
                                           $j('#cause_death_surgery_div').hide();
                                   }
								   if(getValue('primary_cause_death.value')==165143){
                                             $j('#cause_death_other_div').show();
                                   }else{
                                           $j('#cause_death_other_div').hide();
                                   }
			});
		});
		
		jQuery(function() {
			getField('reason_follow_up.value').change(function(){
                                  if(getValue('reason_follow_up.value')==164482){
                                             $j('#reason_follow_up_other_div').show();
                                   }else{
                                           $j('#reason_follow_up_other_div').hide();
                                   }
			});
		});
			
		jQuery(function() {
		getField('not_evaluated_transfer_out.value').change(function(){
							  if(getValue('not_evaluated_transfer_out.value')==1065){
										 $j('#transfer_out_facility_div').show();
							   }else{
									   $j('#transfer_out_facility_div').hide();
									   $j('#transfer_out_facility_other_div').hide();
							   }
			});
		});
			
		jQuery(function() {
		getField('not_evaluated_transfer_out.value').change(function(){
							  if(getValue('not_evaluated_transfer_out.value')==1066){
										 $j('#reason_not_evaluated_other_div').show();
							   }else{
									   $j('#reason_not_evaluated_other_div').hide();
							   }
			});
		});
			
	jQuery(function() {
			getField('transfer_out_facility.value').change(function(){
                                  if(getValue('transfer_out_facility.value')==63){
                                             $j('#transfer_out_facility_other_div').show();
                                   }else{
                                           $j('#transfer_out_facility_other_div').hide();
                                   }
			});
		});
			
		beforeSubmit.push(function() {
        var submit=true;
		setValue('transfer_out_facility_other.error', '');
		if(getValue('transfer_out_facility.value')==63 &amp;&amp; getValue('transfer_out_facility_other.value')==''){
					getField('transfer_out_facility_other.error').html('This field can not be null').show();
					submit=false;
		}
        else{
                getField('transfer_out_facility_other.error').html('').hide();
                submit=true;
        }
				
		if(submit==false){
			return false;
        }
        else{
			var endDate = new Date();
			var timeDiff = Math.abs(endDate.getTime() - startDate.getTime());
			var diffSec = timeDiff/1000;
			alert(diffSec + " seconds to fill form");
            return true;
        }
			
	});
	
	
	</script>

<!-- END OF FORM

Simple examples to copy-and-paste. Full reference at http://wiki.openmrs.org/x/kg8z

SECTION
	<section headerLabel="\#. Title">
		Content
	</section>

NUMERIC OBSERVATION
	<obs conceptId="id-of-numeric-concept" labelText="Label before"/>

DATE OBSERVATION
	<obs conceptId="id-of-date-concept" labelText="Label before"/>

CODED OBSERVATION
(as a dropdown)
	<obs conceptId="id-of-coded-concept" labelText="Label before"/>
(as radio buttons)
	<obs conceptId="id-of-coded-concept" labelText="Label before" style="radio"/>
(as an autocomplete)
	<obs conceptId="id-of-coded-concept" labelText="Label before" style="autocomplete" answerClasses="Diagnosis"/>
(as a checkbox for a specific answer)
	<obs conceptId="id-of-coded-concept" labelText="Label before" answerConceptId="id-of-answer-concept" answerLabel="label for answer"/>
(as a dropdown with specific choices)
	<obs conceptId="id-of-coded-concept" labelText="Label before" answerConceptIds="concept-id-1,concept-id-2,concept-id-3" answerLabels="Label 1,Label 2, Label 3"/>


FREE TEXT OBSERVATION
(as a normal text field)
	<obs conceptId="id-of-text-concept" labelText="Label before"/>
(as a textarea)
	<obs conceptId="id-of-text-concept" labelText="Label before" rows="4" cols="80"/>
-->
</htmlform>